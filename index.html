<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>Tbl_3a9k ‚Äî –ë–∏–æü§ç</title>
<link rel="icon" href="favicon.png" type="image/png" />
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  *{margin:0;padding:0;box-sizing:border-box;scroll-behavior:smooth;}
  body{font-family:'Press Start 2P',cursive;background:#000;color:#fff;overflow-x:hidden;position:relative;min-height:100vh;}
  
  /* Global animated background - covers entire site */
  #global-canvas-bg{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100vh;
    z-index:1;
    pointer-events:none;
    transition: opacity 0.5s ease;
  }
  
  /* Background toggle button - hidden by default */
  .bg-toggle{
    position:fixed;
    top:20px;
    left:20px;
    z-index:200;
    background:transparent;
    border:2px solid white;
    color:white;
    font-family:'Press Start 2P';
    font-size:8px;
    padding:8px 12px;
    cursor:pointer;
    border-radius:5px;
    transition:all 0.3s ease;
    opacity:0;
    visibility:hidden;
  }
  .bg-toggle:hover{
    background:white;
    color:black;
    box-shadow:0 0 10px white;
  }
  .bg-toggle.visible{
    opacity:1;
    visibility:visible;
  }
  
  .header{position:relative;height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;padding:20px;overflow:hidden;background:rgba(0,0,0,0.3);}
  .header h1{font-size:24px;animation:fadeInDown 1.2s ease-out;z-index:4;position:relative;}
  .header p{font-size:14px;margin-top:10px;animation:fadeInUp 1.2s ease-out;z-index:4;position:relative;}
  
  @keyframes fadeInDown{from{opacity:0;transform:translateY(-40px);}to{opacity:1;transform:translateY(0);}}
  @keyframes fadeInUp{from{opacity:0;transform:translateY(40px);}to{opacity:1;transform:translateY(0);}}

  /* language switcher */
  .lang-switcher{position:absolute;top:20px;right:20px;z-index:200;}
  .lang-switcher button{background:transparent;border:2px solid white;color:white;font-family:'Press Start 2P';font-size:10px;padding:5px 10px;margin-left:5px;cursor:pointer;}
  .lang-switcher button:hover{background:white;color:black;}

  /* content sections - positioned above animated background */
  .content{position:relative;z-index:5;padding:100px 20px;text-align:center;background:rgba(0,0,0,0.1);}

  /* site blocks */
  section.about{position:relative;z-index:5;}
  section.about p{margin-top:15px;font-size:12px;line-height:1.6;}
  .info-life{display:flex;justify-content:center;gap:40px;flex-wrap:wrap;margin-bottom:50px;position:relative;z-index:5;}
  .info,.life{flex:1;min-width:280px;max-width:400px;padding:20px;border-radius:15px;background:rgba(0,0,0,0.8);box-shadow:0 0 15px rgba(255,255,255,0.06);text-align:left;backdrop-filter:blur(10px);}
  .info ul,.life ul{list-style:none;padding:0;font-size:12px;line-height:1.6em;}
  .life-avatar{width:120px;height:120px;border-radius:50%;border:2px solid white;object-fit:cover;display:block;margin:0 auto 15px;box-shadow:0 0 12px rgba(255,255,255,0.2);}
  .socials{margin-top:30px;display:flex;justify-content:center;gap:15px;flex-wrap:wrap;position:relative;z-index:5;}
  .socials a img{width:50px;height:50px;border:2px solid white;padding:5px;border-radius:10px;transition:transform .25s,box-shadow .25s;}
  .socials a img:hover{transform:scale(1.1);box-shadow:0 0 15px white;}
  .music-btn{margin-top:30px;background:transparent;border:2px solid white;color:white;font-family:'Press Start 2P';font-size:10px;padding:10px 20px;border-radius:10px;cursor:pointer;transition:transform .25s,box-shadow .25s,background .25s,color .25s;position:relative;z-index:5;}
  .music-btn:hover{background:white;color:black;box-shadow:0 0 15px white;transform:scale(1.05);}
  .screenshots{position:relative;z-index:5;}
  .screenshots h2{font-size:16px;margin-bottom:20px;}
  .screenshots .grid{display:flex;flex-wrap:wrap;justify-content:center;gap:20px;}
  .screenshots img{width:300px;height:auto;border:2px solid white;border-radius:10px;cursor:pointer;transition:transform .25s;}
  .screenshots img:hover{transform:scale(1.05);}
  
  /* Birthday section - ensure it's above animated background */
  .birthday{
    background:rgba(0,0,0,0.8);
    padding:30px;
    border-radius:15px;
    margin:50px auto;
    max-width:400px;
    backdrop-filter:blur(10px);
    position:relative;
    z-index:5;
  }

  /* modal */
  .modal{display:none;position:fixed;z-index:9999;left:0;top:0;width:100%;height:100%;overflow:hidden;background-color:rgba(0,0,0,0.9);}
  .modal-content{display:block;margin:auto;max-width:80%;max-height:80%;}
  .close,.prev,.next{position:absolute;color:white;font-size:30px;cursor:pointer;user-select:none;}
  .close{top:20px;right:35px;}
  .prev,.next{top:50%;transform:translateY(-50%);font-size:40px;padding:16px;}
  .prev{left:10px;} .next{right:10px;}
</style>
</head>
<body>

<!-- Global animated background canvas - covers entire site -->
<canvas id="global-canvas-bg" aria-hidden="true"></canvas>

<!-- Background toggle button - hidden by default -->
<button class="bg-toggle" id="bg-toggle" title="Toggle Background">BG</button>

<!-- language switcher -->
<div class="lang-switcher">
  <button onclick="setLang('ru')">RU</button>
  <button onclick="setLang('en')">EN</button>
</div>

<!-- header - video removed, only particles background -->
<header class="header">
  <h1 id="title-text">Tbl_3a9k - –û–±–æ –º–Ω–µ:</h1>
  <p id="subtitle-text">–±–∞“õ—ã—Ç—Ç—ã —Å–µ–∑—ñ–Ω–¥—ñ–º –º–µ–Ω —Å–µ–Ω–µ–Ω “ì–∞–Ω–∞.ü§ç</p>
</header>

<!-- content with animated bg behind it -->
<div class="content">
  <!-- About -->
  <section class="about">
    <h2 id="about-title">qq, –Ø Tbl_3a9k</h2>
    <p id="about-1">–ú–Ω–µ 13 –ª–µ—Ç, —è –∂–∏–≤—É –≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–µ –∏ –æ–±–æ–∂–∞—é –∏–≥—Ä–∞—Ç—å –≤ MinecraftüéÆ</p>
    <p id="about-2">–ú–æ—è –º–µ—á—Ç–∞ ‚Äî —Å–æ–±—Ä–∞—Ç—å –º–æ—â–Ω—ã–π –ü–ö, –Ω–æ –ø–æ–∫–∞ —è –∫–∞–π—Ñ—É—é —Å–æ —Å–≤–æ–µ–π GTX 1070 Ti –∏ i7 üíª</p>
    <p id="about-3">–ü–æ–æ–±—â–∞—Ç—å—Å—è —Å–æ –º–Ω–æ–π? Discord ‚Äî <strong>tbl_3a9k</strong>. –≥—É–¥–ª–∞–∫</p>
  </section>

  <!-- Info + Life -->
  <section class="info-life">
    <div class="info">
      <ul id="info-list">
        <li>üè≥Ô∏è ‚Ä¢ –ú–æ–∏ —Ü–µ–ª–∏:</li>
        <li>üë§ ‚Ä¢ –ò–º–µ—Ç—å —Å–≤–æ–π —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∑–∞—Ä–∞–±–æ—Ç–æ–∫</li>
        <li>üí¨ ‚Ä¢ –ù–µ –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª–µ–π</li>
        <li>‚õèÔ∏è ‚Ä¢ –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ç–∞–ø</li>
        <li>üéÆ ‚Ä¢ –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞—é –±–ª–∞–≥–æ–¥–∞—Ä—è –∏–≥—Ä–µ Minecraft</li>
        <li>üí´ ‚Ä¢ –ú–æ—è –æ—Å–Ω–æ–≤–Ω–∞—è –º–µ—á—Ç–∞: –ë—ã—Ç—å —Å—á–∞—Å—Ç–ª–∏–≤—ã–º</li>
        <li>üíª ‚Ä¢ –ú–æ–π –ø–µ—Ä–≤—ã–π —É—Å–ø–µ—Ö: 11.09.25 --> 61–∫üí≤</li>
      </ul>
    </div>
    <div class="life">
      <h2 id="life-title">üß© –ú–æ—è –ª–∏—á–Ω–∞—è –∂–∏–∑–Ω—å</h2>
      <img src="images/avatar.png" alt="–ê–≤–∞—Ç–∞—Ä" class="life-avatar">
      <ul id="life-list">
        <li>üéì –£—á—É—Å—å –≤ <b>8 –∫–ª–∞—Å—Å–µ</b></li>
        <li>üèÄ –ò–Ω–æ–≥–¥–∞ –∏–≥—Ä–∞—é –≤ <b>–±–∞—Å–∫–µ—Ç–±–æ–ª</b></li>
        <li>üíû –ü—Ä–æ–≤–æ–∂—É –≤—Ä–µ–º—è —Å –±–ª–∏–∑–∫–∏–º–∏ –ª—é–¥—å–º–∏</li>
        <li>üí∞ –£–∂–µ –ø—Ä–æ–±—É—é –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ–Ω–ª–∞–π–Ω</li>
      </ul>
    </div>
  </section>

  <!-- socials -->
  <div class="socials">
    <a href="https://tiktok.com/@tbl_3a9k.tt" target="_blank" rel="noopener"><img src="images/tiktok.png" alt="TikTok" /></a>
    <a href="https://steamcommunity.com/profiles/76561199146062072/" target="_blank" rel="noopener"><img src="images/steam.png" alt="Steam" /></a>
    <a href="https://www.twitch.tv/tbl_3a9k" target="_blank" rel="noopener"><img src="images/twitch.png" alt="Twitch" /></a>
    <a href="https://open.spotify.com/user/31zywyv4vpxmybv7sjz6gxf776ee" target="_blank" rel="noopener"><img src="images/spotify.png" alt="Spotify" /></a>
    <a href="https://www.roblox.com/users/3276902015/profile?friendshipSourceType=PlayerSearch" target="_blank" rel="noopener"><img src="images/roblox.png" alt="Roblox" /></a>
    <a href="https://funpay.com/users/15229317/" target="_blank" rel="noopener"><img src="images/fanpay.png" alt="FanPay" /></a>
    <a href="https://tiktok.com/@sj1109z" target="_blank" rel="noopener"><img src="images/tiktok.png" alt="TikTok" /></a>
  </div>

  <!-- music -->
  <button class="music-btn" id="musicButton">‚ñ∂ Play Music</button>
  <audio id="mySong">
    <source src="music.mp3" type="audio/mpeg">
    –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ.
  </audio>

  <!-- screenshots -->
  <section class="screenshots">
    <h2 id="screenshots-title">üì∏ –ú–æ–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã</h2>
    <div class="grid">
      <img src="images/screenshot1.png" alt="Screenshot 1" />
      <img src="images/screenshot2.png" alt="Screenshot 2" />
      <img src="images/screenshot3.png" alt="Screenshot 3" />
      <img src="images/screenshot4.png" alt="Screenshot 4" />
      <img src="images/screenshot5.png" alt="Screenshot 5" />
      <img src="images/screenshot6.png" alt="Screenshot 6" />
      <img src="images/screenshot7.png" alt="Screenshot 7" />
      <img src="images/IMBA2.png" alt="IMBA2" />
    </div>
  </section>

  <!-- birthday - now with animated background behind it -->
  <section class="birthday">
    <h2>üéÇ –î–æ –º–æ–µ–≥–æ –î–Ω—è –†–æ–∂–¥–µ–Ω–∏—è</h2>
    <p id="birthday-days">–û—Å—Ç–∞–ª–æ—Å—å: 90 –¥–Ω–µ–π</p>
  </section>
</div>

<!-- modal -->
<div id="modal" class="modal">
  <span class="close">&times;</span>
  <span class="prev">&#10094;</span>
  <span class="next">&#10095;</span>
  <img class="modal-content" id="modal-img">
</div>

<!-- existing scripts (language, modal, music) -->
<script>
  // Background toggle functionality
  const bgToggle = document.getElementById("bg-toggle");
  const canvas = document.getElementById("global-canvas-bg");
  let bgVisible = true;
  
  // Show toggle button on double-click anywhere
  document.addEventListener("dblclick", () => {
    bgToggle.classList.add("visible");
    setTimeout(() => {
      bgToggle.classList.remove("visible");
    }, 3000); // Hide after 3 seconds
  });
  
  bgToggle.addEventListener("click", () => {
    bgVisible = !bgVisible;
    canvas.style.opacity = bgVisible ? "1" : "0";
    bgToggle.textContent = bgVisible ? "BG" : "NO BG";
  });

  // music button
  const button = document.getElementById("musicButton");
  const audio = document.getElementById("mySong");
  let isPlaying=false;
  button.addEventListener("click",()=>{
    if(!isPlaying){ audio.play().catch(()=>{}); button.textContent="‚è∏ Pause Music"; }
    else{ audio.pause(); button.textContent="‚ñ∂ Play Music"; }
    isPlaying=!isPlaying;
  });

  // modal images
  const modal = document.getElementById("modal");
  const modalImg = document.getElementById("modal-img");
  const images = document.querySelectorAll(".screenshots img");
  const closeBtn = document.querySelector(".close");
  const prevBtn = document.querySelector(".prev");
  const nextBtn = document.querySelector(".next");
  let currentIndex=0;
  function openModal(index){ currentIndex=index; modal.style.display="block"; modalImg.src = images[index].src; }
  function closeModal(){ modal.style.display="none"; }
  function showPrev(){ currentIndex=(currentIndex-1+images.length)%images.length; modalImg.src=images[currentIndex].src; }
  function showNext(){ currentIndex=(currentIndex+1)%images.length; modalImg.src=images[currentIndex].src; }
  images.forEach((img,index)=> img.addEventListener("click",()=>openModal(index)));
  closeBtn.addEventListener("click",closeModal);
  prevBtn.addEventListener("click",showPrev);
  nextBtn.addEventListener("click",showNext);
  window.addEventListener("click",(e)=>{ if(e.target===modal) closeModal(); });

  // language switch (keeps your translations)
  const langData = {
    ru:{ title:"Tbl_3a9k - –û–±–æ –º–Ω–µ:", subtitle:"—è —á—É–≤—Å—Ç–≤–æ–≤–∞–ª —Å–µ–±—è —Å—á–∞—Å—Ç–ª–∏–≤—ã–º —Ç–æ–ª—å–∫–æ –±–ª–∞–≥–æ–¥–∞—Ä—è —Ç–µ–±–µ.ü§ç",
         aboutTitle:"qq, –Ø Tbl_3a9k ", about1:"–ú–Ω–µ 13 –ª–µ—Ç, —è –∂–∏–≤—É –≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–µ –∏ –æ–±–æ–∂–∞—é –∏–≥—Ä–∞—Ç—å –≤ MinecraftüéÆ",
         about2:"–ú–æ—è –º–µ—á—Ç–∞ ‚Äî —Å–æ–±—Ä–∞—Ç—å –º–æ—â–Ω—ã–π –ü–ö, –Ω–æ –ø–æ–∫–∞ —è –∫–∞–π—Ñ—É—é —Å–æ —Å–≤–æ–µ–π GTX 1070 Ti –∏ i7 üíª",
         about3:"–ü–æ–æ–±—â–∞—Ç—å—Å—è —Å–æ –º–Ω–æ–π? Discord ‚Äî tbl_3a9k. –≥—É–¥–ª–∞–∫",
         infoList:["üè≥Ô∏è ‚Ä¢ –ú–æ–∏ —Ü–µ–ª–∏:","üë§ ‚Ä¢ –ò–º–µ—Ç—å —Å–≤–æ–π —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∑–∞—Ä–∞–±–æ—Ç–æ–∫","üí¨ ‚Ä¢ –ù–µ –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª–µ–π","‚õèÔ∏è ‚Ä¢ –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ç–∞–ø","üéÆ ‚Ä¢ –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞—é –±–ª–∞–≥–æ–¥–∞—Ä—è –∏–≥—Ä–µ Minecraft","üí´ ‚Ä¢ –ú–æ—è –æ—Å–Ω–æ–≤–Ω–∞—è –º–µ—á—Ç–∞: –ë—ã—Ç—å —Å—á–∞—Å—Ç–ª–∏–≤—ã–º","üíª ‚Ä¢ –ú–æ–π –ø–µ—Ä–≤—ã–π —É—Å–ø–µ—Ö: 11.09.25 --> 61–∫üí≤"],
         lifeList:["üéì –£—á—É—Å—å –≤ 8 –∫–ª–∞—Å—Å–µ","üèÄ –ò–Ω–æ–≥–¥–∞ –∏–≥—Ä–∞—é –≤ –±–∞—Å–∫–µ—Ç–±–æ–ª","üíû –ü—Ä–æ–≤–æ–∂—É –≤—Ä–µ–º—è —Å –±–ª–∏–∑–∫–∏–º–∏ –ª—é–¥—å–º–∏","üí∞ –£–∂–µ –ø—Ä–æ–±—É—é –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ–Ω–ª–∞–π–Ω"],
         screenshotsTitle:"üì∏ –ú–æ–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã" },
    en:{ title:"Tbl_3a9k - About Me:", subtitle:"I felt happy only because of you.ü§ç",
         aboutTitle:"qq, I'm Tbl_3a9k ", about1:"I'm 13 years old, I live in Kazakhstan and I love playing MinecraftüéÆ",
         about2:"My dream is to build a powerful PC, but for now I'm enjoying my GTX 1070 Ti and i7 üíª",
         about3:"Wanna chat with me? Discord ‚Äî tbl_3a9k. good luck",
         infoList:["üè≥Ô∏è ‚Ä¢ My goals:","üë§ ‚Ä¢ Have my own stable income","üí¨ ‚Ä¢ Not depend on parents","‚õèÔ∏è ‚Ä¢ Upgrade my setup","üéÆ ‚Ä¢ Earn money thanks to Minecraft","üí´ ‚Ä¢ My main dream: To be happy","üíª ‚Ä¢ My first success: 11.09.25 --> 61küí≤"],
         lifeList:["üéì Study in 8th grade","üèÄ Sometimes play basketball","üíû Spend time with close people","üí∞ Already trying to earn online"],
         screenshotsTitle:"üì∏ My Screenshots" }
  };
  function setLang(lang){
    document.getElementById("title-text").textContent = langData[lang].title;
    document.getElementById("subtitle-text").textContent = langData[lang].subtitle;
    document.getElementById("about-title").textContent = langData[lang].aboutTitle;
    document.getElementById("about-1").textContent = langData[lang].about1;
    document.getElementById("about-2").textContent = langData[lang].about2;
    document.getElementById("about-3").textContent = langData[lang].about3;
    const infoListEl = document.getElementById("info-list"); infoListEl.innerHTML = "";
    langData[lang].infoList.forEach(item=>{ const li=document.createElement("li"); li.textContent=item; infoListEl.appendChild(li); });
    const lifeListEl = document.getElementById("life-list"); lifeListEl.innerHTML = "";
    langData[lang].lifeList.forEach(item=>{ const li=document.createElement("li"); li.textContent=item; lifeListEl.appendChild(li); });
    document.getElementById("screenshots-title").textContent = langData[lang].screenshotsTitle;
  }
  document.addEventListener("DOMContentLoaded", ()=> setLang("ru") );

  // birthday countdown
  function updateBirthday(){
    const today=new Date();
    let birthday=new Date(today.getFullYear(),10,19); // 19 Nov
    if(today>birthday) birthday.setFullYear(today.getFullYear()+1);
    const diff=Math.floor((birthday-today)/(1000*60*60*24));
    document.getElementById("birthday-days").textContent="–û—Å—Ç–∞–ª–æ—Å—å: "+diff+" –¥–Ω–µ–π";
  }
  updateBirthday();
  setInterval(updateBirthday,1000*60*60*24);
</script>

<!-- Optimized Minecraft-style neon squares background - much better performance -->
<script>
(function(){
  const canvas = document.getElementById('global-canvas-bg');
  const ctx = canvas.getContext('2d', { alpha: true });
  let DPR = Math.min(2, Math.max(1, window.devicePixelRatio || 1)); // Limit DPR for performance
  let W = window.innerWidth, H = window.innerHeight;

  function resize() {
    DPR = Math.min(2, Math.max(1, window.devicePixelRatio || 1));
    W = window.innerWidth;
    H = window.innerHeight;
    canvas.width = Math.floor(W * DPR);
    canvas.height = Math.floor(H * DPR);
    canvas.style.width = W + 'px';
    canvas.style.height = H + 'px';
    ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
  }
  
  window.addEventListener('resize', resize);
  resize();

  // Reduced particle count and optimized settings for better performance
  const COUNT = Math.min(60, Math.floor((W * H) / 15000)); // Dynamic count based on screen size
  const SIZE_MIN = 8, SIZE_MAX = 25;
  const SPEED = 0.01;
  const MOUSE_FORCE = 0.08;

  let mouse = { x: W/2, y: H/2, active: false };
  let mouseTimeout;
  
  window.addEventListener('mousemove', (e)=>{ 
    mouse.x = e.clientX; 
    mouse.y = e.clientY; 
    mouse.active = true;
    clearTimeout(mouseTimeout);
    mouseTimeout = setTimeout(() => { mouse.active = false; }, 100);
  });
  window.addEventListener('mouseleave', ()=>{ mouse.active = false; });

  function rand(a,b){ return a + Math.random()*(b-a); }
  
  // Pre-calculate colors for better performance
  const colors = [
    'rgba(64,224,208,',   // turquoise
    'rgba(138,43,226,',   // blue violet
    'rgba(0,191,255,',    // deep sky blue
    'rgba(75,0,130,',     // indigo
    'rgba(255,20,147,',   // deep pink
    'rgba(50,205,50,',    // lime green
    'rgba(255,215,0,',    // gold
    'rgba(255,69,0,'      // red orange
  ];

  class Pixel {
    constructor() { this.init(true); }
    init(initial=false){
      this.x = rand(0, W);
      this.y = rand(0, H);
      this.size = rand(SIZE_MIN, SIZE_MAX);
      this.baseX = this.x;
      this.baseY = this.y;
      this.z = 0.5 + Math.random()*1.5;
      this.vx = (Math.random()-0.5) * SPEED * this.z * 30;
      this.vy = (Math.random()-0.5) * SPEED * this.z * 30;
      this.colorBase = colors[Math.floor(Math.random() * colors.length)];
      this.alpha = 0.2 + Math.random()*0.5;
      this.rot = Math.random() * Math.PI * 2;
      this.rotSpeed = (Math.random()-0.5) * 0.002 * this.z;
      this.pulsePhase = Math.random() * Math.PI * 2;
      this.pulseSpeed = 0.015 + Math.random() * 0.02;
      if(initial){
        this.x = rand(0,W); this.y = rand(0,H);
      }
    }
    update(){
      this.rot += this.rotSpeed;
      this.pulsePhase += this.pulseSpeed;
      
      // Simplified floating movement
      this.baseX += Math.sin(this.rot) * 0.02 * this.z;
      this.baseY += Math.cos(this.rot) * 0.02 * this.z;

      this.x += this.vx;
      this.y += this.vy;
      this.x += (this.baseX - this.x) * 0.005;
      this.y += (this.baseY - this.y) * 0.005;

      // Optimized mouse interaction - only when mouse is active
      if(mouse.active){
        const dx = mouse.x - this.x;
        const dy = mouse.y - this.y;
        const distSq = dx*dx + dy*dy; // Use squared distance to avoid sqrt
        if(distSq < 62500){ // 250^2
          const force = Math.max(0, (62500 - distSq) / 62500);
          this.x -= dx * MOUSE_FORCE * this.z * force * 0.03;
          this.y -= dy * MOUSE_FORCE * this.z * force * 0.03;
        }
      }

      // Wrap around screen
      if(this.x < -50) this.x = W + 50;
      if(this.x > W + 50) this.x = -50;
      if(this.y < -50) this.y = H + 50;
      if(this.y > H + 50) this.y = -50;
    }
    draw(){
      const pulse = 0.7 + 0.3 * Math.sin(this.pulsePhase);
      const size = this.size * (0.7 + this.z*0.3) * pulse;
      
      ctx.save();
      ctx.translate(this.x, this.y);
      ctx.rotate(this.rot * 0.1);
      ctx.globalCompositeOperation = 'lighter';
      
      // Simplified glow effect - single layer for better performance
      const alpha = Math.min(0.8, this.alpha * pulse);
      ctx.fillStyle = this.colorBase + alpha + ')';
      ctx.shadowBlur = 8 * this.z * pulse;
      ctx.shadowColor = this.colorBase + '0.6)';
      ctx.fillRect(-size/2, -size/2, size, size);
      
      ctx.restore();
      ctx.shadowBlur = 0;
    }
  }

  const pixels = [];
  for(let i=0;i<COUNT;i++) pixels.push(new Pixel());

  // Performance monitoring
  let lastTime = 0;
  let frameCount = 0;
  let fps = 60;

  function frame(currentTime){
    // Simple FPS limiting for better performance
    if (currentTime - lastTime < 16.67) { // ~60fps max
      requestAnimationFrame(frame);
      return;
    }
    
    frameCount++;
    if(frameCount % 60 === 0){
      fps = Math.round(1000 / (currentTime - lastTime));
    }
    lastTime = currentTime;

    ctx.clearRect(0,0,W,H);
    
    // Simplified background
    const g = ctx.createLinearGradient(0,0,0,H);
    g.addColorStop(0, 'rgba(5,0,15,0.1)');
    g.addColorStop(0.5, 'rgba(10,0,20,0.08)');
    g.addColorStop(1, 'rgba(20,0,40,0.12)');
    ctx.fillStyle = g;
    ctx.fillRect(0,0,W,H);
    
    // Draw particles in batches for better performance
    for(let i=0;i<pixels.length;i++){
      pixels[i].update();
      pixels[i].draw();
    }
    
    requestAnimationFrame(frame);
  }
  
  requestAnimationFrame(frame);
})();
</script>
</body>
</html>
